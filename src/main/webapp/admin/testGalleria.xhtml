<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" xmlns:po="http://primefaces.org/rain"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                template="/WEB-INF/templates/main.xhtml">

    <f:metadata>
        <f:event type="preRenderView" listener="#{sensorStationDetailController.init}"/>
    </f:metadata>

    <ui:define name="title">GREENHOUSE DETAILS</ui:define>
    <ui:define name="viewname">
    </ui:define>
    <ui:define name="head">
        <link rel="stylesheet" href="/webjars/font-awesome/6.4.0/css/all.min.css"/>
        <h:outputScript name="js/chart.js"/>
        <script type="text/javascript" src="https://maps.google.com/maps/api/js?sensor=true"></script>

    </ui:define>

    <ui:define name="content">
        <!-- ..........................................TOP INFO BOXES................................................................... -->
        <h:form>
            <p:toolbar>
                <p:toolbarGroup>

                    <div class="col-12 md:col-6 xl:col-3">
                        <!-- ...............................TEMPERATURE BOX........................................ -->
                        <p:commandLink action="#{measurementListController.onTempClick()}" update="myDataTable1">

                            <div class="card  overview-box">

                                <p:graphicImage name="images/dashboard/effect-useronline.svg"/>
                                <span class="overview-icon">
                            <p:graphicImage name="images/dashboard/icon-usersonline.png"/>
                        </span>
                                <div class="overview">
                                    <span class="overview-title">TEMPERATURE</span>
                                    <h3>query</h3>
                                    <span><span>72</span> new measurements since last visit</span>
                                </div>
                            </div>
                        </p:commandLink>
                    </div>

                    <div class="col-12 md:col-6 xl:col-3">
                        <!-- ...............................AIR HUMIDITY BOX........................................ -->
                        <p:commandLink action="#{measurementListController.onAirHumidityClick()}" update="myDataTable1">
                            <div class="card overview-box">
                                <p:graphicImage name="images/dashboard/effect-checkins.svg"/>
                                <span class="overview-icon">
                            <p:graphicImage name="images/dashboard/icon-checkins.png"/>
                        </span>
                                <div class="overview">
                                    <span class="overview-title">AIR HUMIDITY</span>
                                    <h3>532</h3>
                                    <span><span>48</span> new city since last visit</span>
                                </div>
                            </div>
                        </p:commandLink>
                    </div>

                    <div class="col-12 md:col-6 xl:col-3">
                        <!-- ...............................GROUND HUMIDITY BOX........................................ -->
                        <p:commandLink action="#{measurementListController.onGroundHumidityClick()}"
                                       update="myDataTable1">
                            <div class="card overview-box ">
                                <p:graphicImage name="images/dashboard/effect-filessynced.svg"/>
                                <span class="overview-icon">
                            <p:graphicImage name="images/dashboard/icon-filessynced.png"/>
                        </span>
                                <div class="overview">
                                    <span class="overview-title">GROUND HUMIDITY</span>
                                    <h3>12.6%</h3>
                                    <span><span>1.8%</span> increase since last visit</span>
                                </div>
                            </div>
                        </p:commandLink>
                    </div>

                    <div class="col-12 md:col-6 xl:col-3">
                        <!-- ...............................LIGHT INTENSITY BOX........................................ -->
                        <p:commandLink action="#{measurementListController.onLightIntensityClick()}"
                                       update="myDataTable1">
                            <div class="card overview-box">
                                <p:graphicImage name="images/dashboard/effect-messages.svg"/>
                                <span class="overview-icon">
                            <p:graphicImage name="images/dashboard/icon-messages.png"/>
                        </span>
                                <div class="overview">
                                    <span class="overview-title">LIGHT INTENSITY</span>
                                    <h3>440</h3>
                                    <span><span>24</span> new since last visit</span>
                                </div>
                            </div>
                        </p:commandLink>
                    </div>

                </p:toolbarGroup>
            </p:toolbar>
        </h:form>


        <!-- ..........................................PAGE................................................................... -->
        <div class="layout-dashboard">
            <div class="grid">

                <!-- ..........................................PICTURES AWAITING APPROVAL................................................................... -->
                <div class="col-12 md:col-12 xl:col-6">
                    <div class="card chart">
                        <div class="card" >
                            <h5>Galleria</h5>
                            <div class="flex justify-content-center">
                                <p:graphicImage id="displayedimage" value="#{galleryController.photoAsStreamedContent}" alt="#{galleryController.photoAsStreamedContent}" style="width: 20%; display: block">
                                    <f:param name="id" value="#{image.id}" />
                                </p:graphicImage>
                            </div>
                    </div>
                </div>


                <!-- .........................................PICTURES TABLE...................................................... -->
                <div class="col-12 md:col-12 xl:col-6">
                    <div class="card products">
                        <p:dataTable id="myDataTable1" widgetVar="customersDT2" var="image"
                                     value="#{galleryController.images}"
                                     selectionMode="single" reflow="true"
                                     rowKey="#{image.id}" scrollable="true" scrollHeight="350"
                                     styleClass="ui-datatable-striped ui-datatable-sm ui-datatable-gridlines">

                            <!-- ........THIS CAN BE ADDED TO ANY INTERACTIVE ELEMENT TO REFRESH SOMETHING............ -->
                            <p:ajax event="rowSelect" update="displayedimage"
                                    listener="#{galleryController.onRowSelectPicture}"/>

                            <f:facet name="header">
                                <div class="customers-table-header">
                                    <span style="font-weight: bold">Last measurements</span>

                                    <span class="ui-input-icon-left filter-container">
                                        <i class="pi pi-search"/>
                                        <p:inputText id="globalFilter" onkeyup="PF('customersDT2').filter()"
                                                     placeholder="Search"/>
                                    </span>
                                </div>
                            </f:facet>
                            <p:column headerText="Sensor Station" sortBy="#{measurement.sensorStation.sensorStationName}"
                                      filterBy="#{measurement.sensorStation.sensorStationName}">
                                <h:outputText value="#{measurement.sensorStation.sensorStationName}"/>
                            </p:column>
                            <p:column headerText="Plant" sortBy="#{measurement.plant.plantName}"
                                      filterBy="#{measurement.plant.plantName}">
                                <h:outputText style="vertical-align: middle; margin-left: .5rem"
                                              value="#{measurement.plant.plantName}"/>
                            </p:column>
                            <p:column headerText="Measurement" sortBy="#{measurement.value_s}"
                                      filterBy="#{measurement.value_s}">
                                <h:outputText style="vertical-align: middle; margin-left: .5rem"
                                              value="#{measurement.value_s} #{measurement.unit}"/>
                            </p:column>
                            <p:column headerText="Date" sortBy="#{measurement.timestamp}"
                                      filterBy="#{measurement.timestamp}">
                                <h:outputText value="#{measurement.timestamp}"/>
                            </p:column>
                            <p:column headerText="Status">
                                <i class="#{sensorStationDetailController.getlastMeasurementStatusIcon(measurement.type)}"
                                   style="display: flex; justify-content: center; align-items: center; color:#{sensorStationDetailController.getMeasurementStatus(measurement.id,measurement.type) == 'OK' ? 'green' : 'red'}"
                                   title="#{measurement.type}"></i>
                            </p:column>
                            <p:column headerText="Type" sortBy="#{measurement.type}">
                                <h:outputText value="#{measurement.type}"/>
                            </p:column>
                        </p:dataTable>
                    </div>
                </div>



            </div>
        </div>
    </ui:define>
</ui:composition>