<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" xmlns:po="http://primefaces.org/rain" template="/WEB-INF/templates/main.xhtml">

    <ui:define name="title">Plant Health - User Management</ui:define>

    <ui:define name="content">
        <h:form id="form">
            <div class="grid table-demo">
                <div class="col-12">
                    <div class="card">

                                        <!-- CREATE USER WITH DIALOG -->

                        <p:commandButton icon="pi pi-user-plus" value="Create New User" oncomplete="PF('createUserDialog').show()"
                                         ajax="true" class="btn btn-primary" />

                        <p:dialog id="createUserDialog" showEffect="fade" hideEffect="fade"
                                  header="Create New User" widgetVar="createUserDialog" modal="true">
                            <p:panelGrid columns="2" layout="grid">
                                <p:outputLabel for="username" value="Username:" />
                                <p:inputText id="username" value="#{userDetailController.username}" required="true" />

                                <p:outputLabel for="password" value="Password: "/>
                                <p:password id="password" value="#{userDetailController.password}" feedback="true" required="true"/>

                                <p:outputLabel for="firstName" value="First Name: "/>
                                <p:inputText id="firstName" value="#{userDetailController.firstName}" required="false"/>

                                <p:outputLabel for="lastName" value="Last Name: "/>
                                <p:inputText id="lastName" value="#{userDetailController.lastName}" required="false"/>

                                <p:outputLabel for="email" value="Email: "/>
                                <p:inputText id="email" value="#{userDetailController.email}" required="false"/>

                                <p:outputLabel for="phone" value="Phone number: "/>
                                <p:inputNumber id="phone" value="#{userDetailController.phone}" required="false"/>

                                <p:outputLabel for="admin" value="Admin:" />
                                <p:selectBooleanCheckbox id="admin" value="#{userDetailController.admin}">
                                </p:selectBooleanCheckbox>
                                <p:outputLabel for="gardener" value="Gardener:" />
                                <p:selectBooleanCheckbox id="gardener" value="#{userDetailController.gardener}">
                                </p:selectBooleanCheckbox>

                                <p:commandButton value="Create" action="#{userDetailController.doCreateUser}" update="createUserDialog" />
                                <p:commandButton value="Cancel" onclick="PF('createUserDialog').hide()" />

                            </p:panelGrid>
                        </p:dialog>

                        <!-- EDIT USER DIALOG -->

                        <p:dialog id="editUserDialog" showEffect="fade" hideEffect="fade" header="Edit User"
                                  widgetVar="editUserDialog">
                            <p:panelGrid columns="2" layout="grid">

                                <p:outputLabel for="editPassword" value="Password: "/>
                                <p:password id="editPassword" value="#{userDetailController.editPassword}" feedback="true" required="true"/>

                                <p:outputLabel for="editFirstName" value="First Name: "/>
                                <p:inputText id="editFirstName" value="#{userDetailController.editFirstName}" required="false"/>

                                <p:outputLabel for="editLastName" value="Last Name: "/>
                                <p:inputText id="editLastName" value="#{userDetailController.editLastName}" required="false"/>

                                <p:outputLabel for="editEmail" value="Email: "/>
                                <p:inputText id="editEmail" value="#{userDetailController.editEmail}" required="false"/>

                                <p:outputLabel for="editPhone" value="Phone number: "/>
                                <p:inputNumber id="editPhone" value="#{userDetailController.editPhone}" required="false"/>

                                <p:outputLabel for="editAdmin" value="Admin:" />
                                <p:selectBooleanCheckbox id="editAdmin" value="#{userDetailController.editAdmin}">
                                </p:selectBooleanCheckbox>
                                <p:outputLabel for="editGardener" value="Gardener:" />
                                <p:selectBooleanCheckbox id="editGardener" value="#{userDetailController.editGardener}">
                                </p:selectBooleanCheckbox>

                                <p:commandButton value="Edit" action="#{userDetailController.doEditUser}" update="editUserDialog" />
                                <p:commandButton value="Cancel" onclick="PF('editUserDialog').hide()" />

                            </p:panelGrid>
                        </p:dialog>

                        <p:dataTable var="user" value="#{userListController.users}" paginator="true" paginatorPosition="bottom"
                                     rows="10" sortMode="single">
                            <f:facet name="header">
                                <div class="mb-3">

                                    <div class="inline-flex align-items-center" style="vertical-align: middle">
                                    </div>
                                </div>
                            </f:facet>


                            <p:column headerText="Username" sortable="true" sortBy="#{user.username}" filterable="true" filterBy="#{user.username}">
                                <h:outputText value="#{user.username}"/>
                            </p:column>
                            <p:column headerText="First Name" sortable="true" sortBy="#{user.firstName}" filterable="true" filterBy="#{user.firstName}">
                                <h:outputText value="#{user.firstName}"/>
                            </p:column>
                            <p:column headerText="Last Name" sortable="true" sortBy="#{user.lastName}" filterable="true" filterBy="#{user.lastName}">
                                <h:outputText value="#{user.lastName}"/>
                            </p:column>
                            <p:column headerText="Role" sortable="true" sortBy="#{user.roles}" filterable="true" filterBy="#{user.roles}">
                                <h:outputText value="#{user.roles}"/>
                            </p:column>
                            <p:column headerText="Creation Date" sortable="true" sortBy="#{user.createDate}" filterable="true" filterBy="#{user.createDate}">
                                <h:outputText value="#{user.createDate}">
                                </h:outputText>
                            </p:column>

                                                    <!-- DELETE USER BUTTON -->
                            <p:column headerText="" style="white-space: nowrap;">
                                <p:commandButton class="ui-button-danger" icon="pi pi-user-minus" title="Delete" style="margin-right: 10px;" update="@form" action="#{userDetailController.doDeleteUser()}">
                                    <f:setPropertyActionListener value="#{user}" target="#{userDetailController.user}" />
                                    <p:confirm header="Confirmation" message="Are you sure you want to delete this user?" icon="pi pi-exclamation-triangle" />
                                </p:commandButton>
                                <p:confirmDialog global="true" showEffect="fade" hideEffect="fade" width="350" widgetVar="confirmDialog">
                                <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" icon="pi pi-check"/>
                                <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no ui-button-secondary" icon="pi pi-times" />
                                </p:confirmDialog>

                                                <!-- EDIT USER BUTTON WITH DIALOG -->

                                <p:commandButton icon="pi pi-user-edit" title="Edit" oncomplete="PF('editUserDialog').show()"
                                                 ajax="true">
                                    <f:setPropertyActionListener value="#{user}" target="#{userDetailController.userToBeEdited}"/>
                                </p:commandButton>
                            </p:column>
                        </p:dataTable>
                    </div>
                </div>
            </div>
        </h:form>

    </ui:define>
</ui:composition>
